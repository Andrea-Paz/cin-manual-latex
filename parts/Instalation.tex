\chapter{Installation}
\label{cha:Instalation}
\section{How to Build Cinelerra-GG from Developer's Git Repository}%
\label{sec:How_to_build}

These are generic build instructions for building Cinelerra-GG Infinity.  
Known to work on ubuntu, mint, suse/leap, fedora, debian, centos, arch, and slackware.  
It has not been tested on every single possible distro yet so you might expect to have to make some minor changes.  
Patches have been created to build on FreeBSD through the work of another programmer and a Gentoo version is being maintained elsewhere by another programmer.

Alternatively, there are some pre-built dynamic or static binaries which are updated on a fairly regular basis (as long as code changes have been made) available at the link below.


\url{
https://cinelerra-gg.org/download/
}

There are 2 kinds of builds, the default system-build and a single-user build.  
A system build has results which are installed to the system. 
The majority of the files are installed in the standard system paths, but some customization is possible. 
The single user build allows for running completely out of a local user directory so it doesn't affect the system.

We recommend the single-user version when possible.  
It makes it very easy to install a new version without having to delete the older version in case you want it for backup – once you are happy with the new version, all you have to do is delete the entire old directory path.  
Also, if you install a new Operating System version and if you have Cinelerra on separate disk space that is preserved, you won't have to reinstall Cinelerra.  
In addition for purposes of having the ability to interrupt or to see any possible error messages, if you start the application from a terminal window command line you will have more control to catch problems.  
However, the system builds can be useful in a university lab setting where there are possibly multiple users, or multiple versions.

There are two notable differences between “standard” views of Cinelerra and this implementation for the system builds.  
Both of these can be configured during installation.  
These differences make it possible to have several different versions installed without having them “walk” on each other. 










\begin{enumerate}
    \item 
        application name can be set during installation and defaults to: “\texttt{cin}”
    \item 
        the home configuration directory can also be set and defaults to:\\ “\texttt{\$HOME/.bcast5}”
\end{enumerate}

\paragraph{To do a system build,} you should read the \texttt{README} that is at the top level after you get the source.

\begin{enumerate}
    \item 
        You need at least 2.5\,GB of disk storage to operate a build + you need to have “\texttt{git}” installed.
    \item  Obviously in order to install into the system, you must run as \textbf{root}.
    \item  The "\texttt{git}" step has to download many files (approx 100\,MB) so allow time.
    \item  Run the following commands (this takes awhile):

        \begin{lstlisting}[language=bash]
cd /<build_path>/           # this is where you need the 2.5GB of disk space
git clone --depth 1 "git://git.cinelerra-gg.org/goodguy/cinelerra.git" cinelerra5 
cd cinelerra5/cinelerra-5.1 # toplevel directory
        \end{lstlisting}

        NOTE: if your system has never had Cinelerra-GG Infinity installed, you will have to make sure you have all of the compilers and libraries necessary.  
        So on the very first build you should run:

        \begin{lstlisting}[language=bash]
./blds/bld_prepare.sh <os> # where <os> represents the Operating System of centos, fedora, suse, leap, ubuntu, debian.
./autogen.sh
./configure --prefix=/usr  # optional parameters can be added here
make 2>&1 | tee log        # make and log the build
        \end{lstlisting}
    \item  Check for obvious build errors:
        \begin{lstlisting}[language=bash]
grep "\*\*\*.*error" -ai log
        \end{lstlisting}
        If this reports errors and you need assistance or you think improvements can be made to the build s,
        email the log which is listed below to \url{cin@lists.cinelerra-gg.org:}
        \begin{lstlisting}[language=bash]
/<build_path>/cinelerra5/cinelerra-5.1/log
        \end{lstlisting}
    \item  If there are no build errors, finally just run:
        \begin{lstlisting}[language=bash]
    make install
        \end{lstlisting}
    \item  If it all worked, you are all setup. Just click on the cinelerra desktop icon.
\end{enumerate}

\paragraph{To do a single-user build,} read the \texttt{README} that is at the top level after you get the source.
\begin{enumerate}
    \item  You need at least 2.5\,GB of disk storage to operate a build + you need to have  “\texttt{git}” installed.
    \item  Recommend you build and run as \textbf{root}, just to avoid permission issues initially.
    \item  The "\texttt{git}" step has to download many files (approx 100\,MB) so allow time.
    \item  Run the following commands (this takes awhile):
        \begin{lstlisting}[language=bash]
cd /<build_path>/           # this is where you need the 2.5GB of disk space
git clone --depth 1 "git://git.cinelerra-gg.org/goodguy/cinelerra.git" cinelerra5 
cd cinelerra5/cinelerra-5.1 # toplevel directory
        \end{lstlisting}
\end{enumerate}

NOTE: if your system has never had Cinelerra-GG Infinity installed, you will have to make sure all
the compilers and libraries necessary are installed. So on the very first build you should run as \textbf{root}:

\begin{lstlisting}[language=bash]
./blds/bld_prepare.sh <os>     # where <os> represents the Operating System of centos, fedora, suse, leap, ubuntu, debian.
./autogen.sh
./configure --with-single-user # the “with-single-user” parameter makes it so
make 2>&1 | tee log            # make and log build (check for errors before proceeding)
make install
\end{lstlisting}

Then just start the application by keying in: ./cin in the bin subdirectory OR add a desktop icon by
using the appropriate directory to copy the files to, run as \textbf{root}, and edit to correct the directory path.

\begin{lstlisting}[language=bash]
cd /cinelerra_directory_path
cp -a image/cin.{svg,xpm} /usr/share/pixmaps/.
cp -a image/cin.desktop /usr/share/applications/cin.desktop
change the “Exec=cin” line to be “Exec=<your_directory_path>/bin/cin”
\end{lstlisting}

The preceding directions for doing a single-user build has been meticulously followed to build and run
on a newly installed ubuntu 15 system WITHOUT BEING ROOT except for the \texttt{bld\_prepare.sh} and creating the desktop icon.

\subsection{Notable Options and Caveats}%
\label{sub:notable_options_and_caveats}

These procedures and the Cinelerra-GG Infinity software have all been run as “\textbf{root}” on various home laptops and desktops. This provides the best chance to ensure all works correctly and also allows for handling errors, other problems and potential crashes with the most success.  Included in this section are some of the build variations easily available for normal builds.

To see the full list of features use:	 

\begin{lstlisting}[language=bash]
./configure –help
\end{lstlisting}
The default build is a system build which uses:    

\begin{lstlisting}[language=bash]
./configure –without-single-user
\end{lstlisting}

In the single-user build, the target directory is always “cin”.  
Because this is also the developer build, constant names are used throughout.  
However, you can rename files after the install is complete.

f your distro/operating system has issues with the default install to \texttt{/usr/local}, you might have to change the location to /usr for a system build.  Then you will have to use:
\begin{lstlisting}[language=bash]
./configure --prefix=/usr
\end{lstlisting}

If you wish to change the default directory for a system build you will have to add the destination directory path on the “\texttt{make install}” line.  For example:
\begin{lstlisting}[language=bash]
make install DESTDIR=<your selected target directory path>
\end{lstlisting}

The application name can be set during installation, but defaults to cin so that the GG/Infinity build can coexist with other Cinelerra builds if necessary.  To override the default cin name, use:	
\begin{lstlisting}[language=bash]
./configure --with-exec-name=cinelerra
\end{lstlisting}

The home configuration directory can also be set, but defaults to \texttt{\$\$HOME/.bcast5}.  
For example:

\begin{lstlisting}[language=bash]
./configure –with-config-dir=/myusername/.bcast5
\end{lstlisting}

NOTE:  when you specify parameters to the configure program, it will create a make file as a consequence.  
Since in a make file, the \$ is a special character, it must be escaped so in order to represent a \$ as part of an input parameter, it has to be stuttered.  
That is, you will need \$\$ (2 dollar signs) to represent a single dollar sign. 

It may be necessary on some distros which have missing or incomplete up-to-date libraries, to build cinelerra without Ladspa.  
To do so, use:

\begin{lstlisting}[language=bash]
./configure --prefix=/usr --without-ladspa-build
\end{lstlisting}

Note that the with-ladspa-dir is the ladspa search path, and exists even if the ladspa build is not selected.  This gives you the ability to specify an alternate ladspa system path by utilizing the \texttt{LADSPA\_PATH} environment variable (that is, the default ladspa build is deselected).

Note for 32-bit 14.2 Slackware, Debian, Gentoo, Arch, FreeBSD, before running the configure, you will need to set up the following:

\begin{lstlisting}[language=bash]
export ac_cv_header_xmmintrin_h=no
export FFMPEG_EXTRA_CFG=" --disable-vdpau"
\end{lstlisting}

\subsection{Notes about Building from Git in your Customized Environment}%
\label{sub:notes_about_building_from_git_in_your_customized_environment}

Getting a build to work in a custom environment is not easy.  If you have already installed libraries which are normally in the thirdparty build, getting them to be recognized means you have to install the "devel" version so the header files which match the library interfaces exist.  Below is the list of thirdparty builds, but this list may have changed over time:
% It's list of Table?

\begin{table}[htpb]
    \centering
    \caption{List of thirdparty builds}
    \label{tab:List_of_thirdparty_builds}
    \begin{tabular}{m{8em}c}
        \toprule
 	a52dec   & yes\\
 	djbfft   & yes\\
	fdk      & auto\\
 	ffmpeg   & yes\\
 	fftw     & auto\\
 	flac     & auto\\
 	giflib   & yes\\
 	ilmbase&auto\\
 	lame    &  auto\\
 	libavc1394&auto\\
 	libraw1394&auto\\
 	libiec61883&auto\\
	libdv     &auto\\
 	libjpeg   &auto\\
 	openjpeg  &auto\\
 	libogg    &auto\\
 	libsndfile&auto\\
 	libtheora&auto\\
 	libuuid  & yes\\
 	libvorbis&auto\\
 	mjpegtools&yes\\
 	openexr   &auto\\
	tiff      &auto\\
 	twolame   &auto\\
 	x264      &auto\\
 	x265      &auto\\
 	libvpx	&auto\\
	libwebp&auto\\
	libaom&	auto\\
    \bottomrule
    \end{tabular}
\end{table}


The "yes" means force build and “auto” means probe and use the system version if the build operation is not static.  
To get your customized build to work, you need to change the probe options for the conflicting libraries from "yes" to "auto", or even rework the \texttt{configure.ac} script.  
There may be several libraries which need special treatment.

An example of a problem you might encounter with your customized installation is with “\texttt{a52dec}” which has probes \texttt{(CHECK\_LIB/CHECK\_HEADER)} in \texttt{configure.ac}, but \texttt{djbfft} does not.  
In this case, \texttt{djbfft} is only built because \texttt{a52dec} is built, so if your system has \texttt{a52dec}, set \texttt{a52dec} to auto and see if that problem is solved by retrying the build with:  
\begin{lstlisting}[language=bash]
./confgure --with-single-user –enable-a52dec=auto .
\end{lstlisting}

With persistence, you can get results, but it may take several tries to stabilize the build.  
If you need help, email the "\texttt{log}" and "\texttt{config.log}", which is usually sufficient to determine why a build failed.

If you have already installed the \texttt{libfdk\_aac} development package on your computer because you prefer this version over the default aac, you will have to do the following to get this alternative operational.

\begin{lstlisting}[language=bash]
export FFMPEG_EXTRA_CFG=" --enable-libfdk-aac --enable-nonfree"
export EXTRA_LIBS=" -lfdk-aac"
for f in `grep -lw aac cinelerra-5.1/ffmpeg/audio/*`; do
  sed -e 's/\<aac\>/libfdk_aac/' -i $f
done
\end{lstlisting}




